# C 语言概述

## 简单的 C 程序示例

[first.c](first.c)

**程序调整：** 如果程序的输出在屏幕上一闪而过，这是因为某些窗口环境会在单独的窗口运行程序，然后在程序运行结束后自动关闭窗口。如果遇到
这种情况，可以在程序中添加额外的代码，让客串等待用户按下一个键后才关闭。一种方法是，在程序的 return 语句前添加一行代码：

```
getchar();
```

这行代码会让程序等待击键，窗口会在用户按下一个键后才关闭。


## 示例解释

组成 C 程序的几个部分：

![c](WX20180207-143849.png)

### 快速概要

现在简述 [first.c](first.c) 程序中的每行代码的作用。

```
#include <stdio.h>                                                  // <-  包含另一个文件。该行告诉编译器把 stdio.h 中的内容包含在当前程序中
int main(void)                                                      // <-  函数名。圆括号表明 main() 是一个函数名；int 表明 main() 函数返回一个整数。void 表明 main() 不带任何参数
/* 一个简单的 C 程序 */                                               // <-  注释。注释只是为了帮助读者理解程序，编译器会忽略它们
{                                                                   // <-  函数体开始
int num;                                                            // <-  声明。该声明表明，将使用一个名为 num 的变量，而且 num 是 int（整数）类型
num = 1;                                                            // <-  赋值表达式语句。把值 1 赋给名为 num 的变量
printf("I am a simple ");                                           // <-  调用一个函数。
printf("computer.\n");                                              // <-  调用一个函数。
printf("My favorite number is %d because it it first.\n", num);     // <-  调用一个函数。
return 0;                                                           // <-  return 语句。C 函数可以给调用方提供（或返回）一个数。
}                                                                   // <-  结束。
``` 

### 程序细节

1.  \#include 指令和头文件
    
    `#include <stdio.h>`的作用相当于把`stdio.h`文件中的所有内容都输入该行所在的位置。实际上，这是一种"拷贝-粘贴"操作。`include`文
    件提供了一种方便的途径共享许多程序共有的信息。`#include`这行代码是一条**C预处理器指令(preprocessor directive)**。通常，C 编译
    器会在编译前对源代码做一些准备工作，即**预处理(preprocessing)**。通常在 C 程序顶部的信息集合被称为**头文件(header)**。
   
    ```
    注意 为何不内置输入和输出
    
    原因之一，并非所有的程序都会用到 I/O（输入/输出）包。轻装上阵表现了 C 语言的哲学。正是这种经济使用资源的原则，使得 C 语言成为流行
    的嵌入式编程语言。 
    ``` 

2.  main() 函数

    C 程序一定从`main()`函数开始执行（目前不必考虑例外的情况）。圆括号用于识别`main()`是一个函数。除了`main()`函数，可以任意命名其他
    函数。`int`是`main()`函数的返回类型。这表明`main()`函数返回的值是整数。返回到哪里？返回给操作系统。
    
3.  注释

    `/* 一个简单的程序 */`。在程序中，被`/**/`两个符号括起来的部分是程序的注释，该注释可以放在任意的地方，甚至与要解释的内容放在同一行，
    也可以单独一行或多行。C99 新增了另一种风格的注释，普遍用于 C++ 和 Java，使用`//`符号创建，仅限于单行。
    
4.  花括号、函数体和块

    ```{ ... }```。花括号把`main()`函数括起来。一般而言，所有的 C 函数都使用花括号标记函数体的开始和结束，这是规定。花括号还可用于把
    函数中的多条语句合并为一个单元或块。
    
5.  声明

    `int num;`。这行代码叫做**声明(declaration)**。声明是 C 语言最重要的特性之一。在该例中，声明完成了两件事。其一，在函数中有一个名
    为`num`的**变量(variable)**。其二，`int`表明`num`是一个整数。`int`是一种**数据类型**。编译器使用这些信息为`num`变量在内存中分配
    存储空间。
    
    `num`是一个**标识符(identifier)**，也就一个变量、函数或其他实体的名称。因此，声明把特定标识符与计算机内存中的特定位置联系起来，同
    时也确定了储存在某位置的信息类型或数据类型。
    
    在 C 语言中，所有变量都必须先声明才有使用。
    
    * 数据类型：C 语言可以处理多种类型的数据，如整数、字符和浮点数。
    
    * 命名：给变量命名时要使用有意义的变量名或标识符。如果变量名无法清楚地表达自身的用途，可以注释中进一步说明。**这是一种良好的编程习惯和编程
    技巧。C99 和 C11 允许使用更长的标识符名，但是编译器只识别前 63 个字符。对于外部标识符，只允许使用 31 个字符。（以前 C90 只允许 6 个字
    符，旧式编译器通常最多只允许使用 8 个字符。如果使用更长的字符，编译器会忽略超出的字符。
    
    * 声明变量的 4 个理由：方便读者查找和理解程序的用途；促使在编写程序之前做一些计划；有助于发现隐藏在程序中的小错误，如变量名拼写错误；未声
    明变量，C 程序无法通过编译。
    
6.  赋值

    `num = 1;`。这行代码是**赋值表达式语句**。在执行`int num;`声明时，编译器在计算机内存中为变量 num 预留了空间，然后在执行这行赋值
    表达式语句时，把值储存在之前预留的位置。可以给 num 赋不同的值，这就是 num 之所以被称为**变量(variable)**的原因。
    
    ```
    注意：C 语言是通过赋值运算符而不是赋值语句完成赋值操作。根据 C 标准，C 语言并没有所谓的"赋值语句"。"赋值语句"实际上是表达式语句。
    ```
    
7.  printf 函数
    
    `printf("I am a simple ");`。圆括号表明 printf 是一个函数名。圆括号中的内容是从 main() 函数传递给 printf() 函数的信息。该信息
    被称为**参数**，更确切地说，是函数的**实际参数(actual argument)**。在 C 语言中，**实际参数（简称实参）**是传递给函数的特定值，
    **形式参数（简称形参）**是函数中用于储存值的变量。
    
    在该程序中，当运行到该行时，控制权被转给已命名的函数(printf())。函数执行结束后，控制权被返回到**主调函数(calling function)**，该
    例中为 main()。
    
8.  return 语句

    `return 0;`。return 语句是程序中的最后一条语句。`int main(void)`中的 int 表明 main() 函数应返回一个整数。C 标准要求 main() 
    这样做。有返回值的 C 函数要用 return 语句。如果遗漏 main() 函数中的 return 语句，程序在运行至最外面的右花括号时会返回 0。因此，可以省
    略 main() 函数末尾的 return 语句。但是，不要在其他有返回值的函数中漏掉它。因此，应该养成在 main() 函数中保留 return 语句的好习惯。尤
    其，对于某些操作系统(包括 UNIX 和 Linux)，return 语句有实际的用途。 
    
## 简单的程序的结构

**程序**由一个或多个函数组成，必须有 main() 函数。**函数**由函数头和函数体组成。**函数头**包括函数名、传入该函数的信息类型和函数的返回类型。
通过函数名后的圆括号可识别出函数，圆括号里可能为空，可能有参数。**函数体**被花括号括起来，由一系列语句、声明组成。简而言之，一个简单的 C 程序
的格式如下：

```
#include <stdio.h.>
int main(void)
{
    语句
    return 0;
}
```
    
## 提高程序可读性的技巧

前面介绍过两种提高程序可读性的技巧：选择有意义的函数名和写注释。注意，使用这两种技巧时应相得益彰，避免重复啰嗦。

提高程序可读性的第 3 个技巧是：在函数中用空行分隔概念上的多个部分。例如，在 [first.c](first.c) 中用空行把声明部分和程序其他部分区分开来。

提高程序可读性的第 4 个技巧是：每条语句各占一行。

## 进一步使用 C

[fathms_ft.c](fathm_ft.c)

### 程序说明

程序在开始处有一条注释（使用新的注释风格），给出了文件名和程序的目的。

### 多条声明

接下来，程序在一条声明中声明了两个变量，而不是一个变量。为此，要在声明中用逗号隔开两个变量(feet 和 fathoms)。也就是说，

```
int feet, fathoms;
```

和 

```
int feet;
int fathoms;
```

等价。

### 乘法

然后，程序进行了乘法运算，语句`feet = 6 * fathoms;`。

### 打印多个值

## 多个函数

[two_func.c](two_func.c)

butler() 函数在程序中出现了 3 次。第 1 次是**函数原型(prototype)**，告知编译器在程序中要使用该函数；第 2 次以**函数调用(function call)**
的形式出现在 main() 中；最后一次出现在**函数定义(function definition)**中，函数定义即是函数本身的源代码。